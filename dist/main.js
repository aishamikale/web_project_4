(()=>{"use strict";const e={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"};class t{constructor({data:e,handleCardClick:t},s){this._link=e.link,this._name=e.name,this._templateSelector=s,this._handleCardClick=t}_likeButton(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like_button_active")}_deleteButton(){this._cardElement.remove()}_setEventListeners(){const e=this._cardElement.querySelector(".card__like-button"),t=this._cardElement.querySelector(".card__delete-button"),s=this._cardElement.querySelector(".card__image");t.addEventListener("click",(()=>this._deleteButton())),e.addEventListener("click",(()=>this._likeButton())),s.addEventListener("click",(()=>this._handleCardClick(this._link,this._name)))}_getTemplate(){return document.querySelector(".card-template").content.querySelector(".card")}generateCard(){this._cardElement=this._getTemplate().cloneNode(!0);const e=this._cardElement.querySelector(".card__image"),t=this._cardElement.querySelector(".card__title");return e.style.backgroundImage=`url(${this._link})`,e.alt=this._name,t.textContent=this._name,this._setEventListeners(),this._cardElement}}class s{constructor(e,t){this._settings=e,this._formElement=t,this._inputs=e.inputs,this._button=e.button}_showErrorMessage(e){const t=this._formElement.querySelector("#"+e.id+"-error");t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass),e.classList.add(this._settings.inputErrorClass)}_hideErrorMessage(e){const t=document.querySelector("#"+e.id+"-error");t.textContent="",t.classList.remove(this._settings.errorClass),e.classList.remove(this._settings.inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideErrorMessage(e):this._showErrorMessage(e)}_toggleButtonState(){this._inputs.every((e=>e.validity.valid))?(this._button.classList.remove(this._settings.inactiveButtonClass),this._button.disabled=!1):(this._button.classList.add(this._settings.inactiveButtonClass),this._button.disabled=!0)}_setEventListeners(){this._inputs=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._button=this._formElement.querySelector(this._settings.submitButtonSelector),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._inputs.forEach((e=>{this._hideErrorMessage(e)})),this._toggleButtonState()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class n{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_open"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_open"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal__button")||e.target.classList.contains("modal"))&&this.close()}))}}class r extends n{constructor({popupSelector:e,handleFormSubmit:t}){super(e),this._handleFormSubmit=t,this._form=this._popupElement.querySelector(".form")}_getInputValues(){return this._inputList=this._popupElement.querySelectorAll(".form__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}close(){super.close(),this._form.reset()}}const o=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button"),l=document.querySelector(".form__input_type_name"),a=document.querySelector(".form__input_type_title"),c=document.querySelector(".form__input_type_card-title"),d=document.querySelector(".form__input_type_url"),_=new s(e,document.querySelector(".form_type_edit-profile")),u=new s(e,document.querySelector(".form_type_add-card"));function m(e){return new t({data:e,handleCardClick:(e,t)=>{p.open(e,t)}},".card-template").generateCard()}_.enableValidation(),u.enableValidation();const h=new class{constructor({nameSelector:e,jobSelector:t}){this._userName=document.querySelector(e),this._userJob=document.querySelector(t)}getUserInfo(){return{name:this._userName.textContent,job:this._userJob.textContent}}setUserInfo(e,t){this._userName.textContent=e,this._userJob.textContent=t}}({nameSelector:".profile__title",jobSelector:".profile__subtitle"}),p=new class extends n{constructor(e){super(e)}open(e,t){this._popupElement.querySelector(".modal__image").src=e,this._popupElement.querySelector(".modal__image-title").textContent=t,super.open()}}(".modal_type_image"),E=new class{constructor({items:e,renderer:t},s){this._renderedItems=e,this._renderer=t,this._classSelector=document.querySelector(s)}renderItems(){this._renderedItems.forEach((e=>this._renderer(e)))}addItem(e){this._classSelector.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:e=>{E.addItem(m(e))}},".cards__grid");E.renderItems();const y=new r({popupSelector:".modal_type_edit-profile",handleFormSubmit:()=>{h.setUserInfo(l.value,a.value),y.close()}}),S=new r({popupSelector:".modal_type_add-card",handleFormSubmit:()=>{E.addItem(m({name:c.value,link:d.value})),S.close()}});y.setEventListeners(),S.setEventListeners(),p.setEventListeners(),o.addEventListener("click",(()=>{const e=h.getUserInfo();l.value=e.name,a.value=e.job,y.open(),_.resetValidation()})),i.addEventListener("click",(()=>{S.open(),u.resetValidation()}))})();